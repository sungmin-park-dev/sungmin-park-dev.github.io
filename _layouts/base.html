<!doctype html>
<html lang="{{ site.lang | default: 'en' }}">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO -->
    <title>{% if page.title %}{{ page.title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
    <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="{{ '/assets/img/favicons/apple-touch-icon.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ '/assets/img/favicons/favicon-32x32.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ '/assets/img/favicons/favicon-16x16.png' | relative_url }}">
    <link rel="manifest" href="{{ '/assets/img/favicons/site.webmanifest' | relative_url }}">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Emergence Design System CSS -->
    <link rel="stylesheet" href="{{ '/assets/css/emergence.css' | relative_url }}">

    <!-- Theme tokens from _data/ (overrides SCSS defaults â€” edit theme_dark.yml / theme_light.yml) -->
    {% if site.data.theme_dark %}
    <style>
      :root {
        {% for token in site.data.theme_dark %}--{{ token[0] }}: {{ token[1] }};
        {% endfor %}
      }
      {% if site.data.theme_light %}[data-theme="light"] {
        {% for token in site.data.theme_light %}--{{ token[0] }}: {{ token[1] }};
        {% endfor %}
      }{% endif %}
    </style>
    {% endif %}

    <!-- FOUC prevention: apply saved theme before CSS renders -->
    <script>
      (function(){
        var t = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', t);
      })();
    </script>
  </head>
  <body>
    {{ content }}
    <footer class="site-footer">
      <span>&copy; emergence &middot; designed by Sung-Min Park</span>
    </footer>

    <!-- Theme Toggle + Hamburger JS -->
    <script>
      (function(){
        // Theme toggle
        var btn = document.getElementById('theme-toggle');
        var icon = document.getElementById('theme-icon');
        function updateIcon(theme) {
          if (!icon) return;
          icon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }
        var currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
        updateIcon(currentTheme);
        if (btn) {
          btn.addEventListener('click', function() {
            var cur = document.documentElement.getAttribute('data-theme') || 'dark';
            var next = cur === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            updateIcon(next);
          });
        }

        // Hamburger menu
        var hamburger = document.getElementById('nav-hamburger');
        var navLinks = document.querySelector('.nav-links');
        if (hamburger && navLinks) {
          hamburger.addEventListener('click', function() {
            hamburger.classList.toggle('open');
            navLinks.classList.toggle('open');
          });
        }
      })();
    </script>
  </body>
</html>
